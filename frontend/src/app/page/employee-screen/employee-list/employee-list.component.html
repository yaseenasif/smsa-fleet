<div class="flex flex-row">
  <app-sidebar></app-sidebar>
  <div class="body-position">
    <div class="body-holder">
      <app-dashboard-head></app-dashboard-head>

      <div class="main">
        <p-toast></p-toast>
        <div class="card flex justify-content-center">
          <!-- <p-breadcrumb class="max-w-full" [model]="items"></p-breadcrumb> -->
          <p-button
            class="bg-b-color adjust mt-3"
            (click)="downloadExcelData()"
          >
            <i class="bi bi-download"></i>&nbsp; Export data
          </p-button>
        </div>
        <div class="body-card">
          <div class="table-head">
            <div
              class="flex mb-2 align-items-center gap-1 mt-5"
              style="justify-content: flex-end; align-items: flex-end"
            >
              <p-button class="bg-b-color" routerLink="/add-employee">
                <i
                  class="bi bi-plus-lg"
                  style="font-size: 20px; font-weight: bold"
                ></i
                >&nbsp;Add Employee
              </p-button>
              <div class="flex flex-column gap-2 ml-5">
                <p-fileUpload
                  #fileUpload
                  icon="pi pi-download"
                  iconPos="left"
                  styleClass="p-button-outlined p-button-sm"
                  mode="basic"
                  chooseLabel="Upload"
                  name="myfile[]"
                  [customUpload]="true"
                  (uploadHandler)="onUpload($event)"
                  (onSelect)="onFileSelect()"
                >
                </p-fileUpload>
                <ng-container *ngIf="fileSelected">
                  <button
                    class="p-button p-button-outlined p-button-sm"
                    (click)="onCancel()"
                  >
                    Cancel
                  </button>
                </ng-container>
              </div>
              <div class="flex flex-column gap-2 ml-5">
                <p-button
                  label="Download Sample"
                  (click)="downloadAttachment(fileName)"
                  icon="bi bi-download"
                ></p-button>
              </div>
            </div>
            <p-toolbar>
              <div class="p-toolbar-group-start">
                <h2 class="h-color">Employee</h2>
              </div>
              <div class="form-hook">
                <p-dropdown
                  class="w-full"
                  [(ngModel)]="selectedStatus"
                  [options]="employeeStatus"
                  name="selectedStatus1"
                  #selectedStatus1="ngModel"
                  [required]="true"
                  optionLabel="name"
                  [filter]="true"
                  filterBy="name"
                  [showClear]="true"
                  (onChange)="OnSelectChange()"
                >
                  <ng-template pTemplate="selectedItem">
                    <div
                      class="flex align-items-center gap-2"
                      *ngIf="selectedStatus"
                    >
                      <div>{{ selectedStatus.name }}</div>
                    </div>
                  </ng-template>
                  <ng-template let-employeeStatus pTemplate="item">
                    <div class="flex align-items-center gap-2">
                      <div>{{ employeeStatus.name }}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
              <div class="card flex flex-wrap justify-content-center gap-3">
                <span class="p-input-icon-left">
                  <i class="my-relative bi bi-search"></i>
                  <input
                    type="text"
                    pInputText
                    [(ngModel)]="value"
                    (input)="OnSelectChange()"
                    placeholder="Search Employee Number"
                  />
                </span>
              </div>
            </p-toolbar>
          </div>

          <div class="card">
            <p-table [value]="employee" [tableStyle]="{ 'min-width': '50rem' }">
              <ng-template pTemplate="header">

                <tr>
                  <th pSortableColumn="id" class="text-center">
                    ID <p-sortIcon field="id"></p-sortIcon>
                  </th>
                  <th pSortableColumn="employeeNumber" class="text-center">
                    Employee Number
                    <p-sortIcon field="employeeNumber"></p-sortIcon>
                  </th>
                  <th pSortableColumn="budgetRef" class="text-center">
                    Budget Ref <p-sortIcon field="budgetRef"></p-sortIcon>
                  </th>
                  <th pSortableColumn="empName" class="text-center">
                    Employee Name <p-sortIcon field="empName"></p-sortIcon>
                  </th>
                  <th pSortableColumn="gender" class="text-center">
                    Gender <p-sortIcon field="gender"></p-sortIcon>
                  </th>
                  <!-- <th pSortableColumn="maritalStatus" class="text-center">
                    Marital Status
                    <p-sortIcon field="maritalStatus"></p-sortIcon>
                  </th> -->
                  <th pSortableColumn="dateOfBirth" class="text-center">
                    DOB <p-sortIcon field="dateOfBirth"></p-sortIcon>
                  </th>
                  <th pSortableColumn="joiningDate" class="text-center">
                    DOJ <p-sortIcon field="joiningDate"></p-sortIcon>
                  </th>
                  <th pSortableColumn="jobTitle" class="text-center">
                    Job Title <p-sortIcon field="jobTitle"></p-sortIcon>
                  </th>
                  <th pSortableColumn="division" class="text-center">
                    Division <p-sortIcon field="division"></p-sortIcon>
                  </th>
                  <th pSortableColumn="department" class="text-center">
                    Department <p-sortIcon field="department"></p-sortIcon>
                  </th>
                  <th pSortableColumn="section" class="text-center">
                    Section <p-sortIcon field="section"></p-sortIcon>
                  </th>
                  <th pSortableColumn="fleetClassification" class="text-center">
                    Fleet Classification <p-sortIcon field="fleetClassification"></p-sortIcon>
                  </th>
                  <th pSortableColumn="vehicleEligible" class="text-center">
                    Vehicle Eligible <p-sortIcon field="vehicleEligible"></p-sortIcon>
                  </th>
                  <th pSortableColumn="deptCode" class="text-center">
                    Dept Code <p-sortIcon field="deptCode"></p-sortIcon>
                  </th>
                  <th pSortableColumn="status" class="text-center">
                    Status <p-sortIcon field="status"></p-sortIcon>
                  </th>
                  <th pSortableColumn="country" class="text-center">
                    Country <p-sortIcon field="country"></p-sortIcon>
                  </th>
                  <th pSortableColumn="region" class="text-center">
                    Region <p-sortIcon field="region"></p-sortIcon>
                  </th>
                  <th pSortableColumn="city" class="text-center">
                    City <p-sortIcon field="city"></p-sortIcon>
                  </th>
                  <th pSortableColumn="location" class="text-center">
                    Location <p-sortIcon field="location"></p-sortIcon>
                  </th>
                  <th pSortableColumn="organization" class="text-center">
                    Organization <p-sortIcon field="organization"></p-sortIcon>
                  </th>

                  <th pSortableColumn="nationalIdNumber" class="text-center">
                    National Id Number
                    <p-sortIcon field="nationalIdNumber"></p-sortIcon>
                  </th>
                  <th pSortableColumn="svEmployeeNumber" class="text-center">
                    SV Emp No. <p-sortIcon field="svEmployeeNumber"></p-sortIcon>
                  </th>
                  <th pSortableColumn="svEmployeeName" class="text-center">
                    SV Emp Name <p-sortIcon field="svEmployeeName"></p-sortIcon>
                  </th>
                  <th pSortableColumn="costCentre" class="text-center">
                    Cost Centre <p-sortIcon field="costCentre"></p-sortIcon>
                  </th>
                  <th pSortableColumn="nationality" class="text-center">
                    Nationality <p-sortIcon field="nationality"></p-sortIcon>
                  </th>
                  <th pSortableColumn="email" class="text-center">
                    Email <p-sortIcon field="email"></p-sortIcon>
                  </th>
                  <th pSortableColumn="contactNumber" class="text-center">
                    Contact No <p-sortIcon field="contactNumber"></p-sortIcon>
                  </th>
                  <th pSortableColumn="grade" class="text-center">
                    Grade <p-sortIcon field="grade"></p-sortIcon>
                  </th>
                  <th pSortableColumn="licenseNumber" class="text-center">
                    License Number
                    <p-sortIcon field="licenseNumber"></p-sortIcon>
                  </th>
                  <th pSortableColumn="vehicleBudget" class="text-center">
                    Vehicle Budget
                    <p-sortIcon field="vehicleBudget"></p-sortIcon>
                  </th>
                  <th class="text-center">Actions</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-employee>
                <tr>
                  <td class="text-center">{{ employee.id }}</td>
                  <td class="text-center">{{ employee.employeeNumber }}</td>
                  <td class="text-center">{{ employee.budgetRef }}</td>
                  <td class="text-center">{{ employee.empName }}</td>
                  <td class="text-center">{{ employee.gender }}</td>
                  <!-- <td class="text-center">{{ employee.maritalStatus }}</td> -->
                  <td class="text-center">{{ employee.dateOfBirth }}</td>
                  <td class="text-center">{{ employee.joiningDate }}</td>
                  <td class="text-center">{{ employee.jobTitle }}</td>
                  <td class="text-center">{{ employee.division }}</td>
                  <td class="text-center">{{ employee.department }}</td>
                  <td class="text-center">{{ employee.section }}</td>
                  <td class="text-center">{{ employee.fleetClassification }}</td>
                  <td class="text-center">{{ employee.vehicleEligible }}</td>
                  <td class="text-center">{{ employee.deptCode }}</td>
                  <td class="text-center">{{ employee.status }}</td>
                  <td class="text-center">{{ employee.country }}</td>
                  <td class="text-center">{{ employee.region }}</td>
                  <td class="text-center">{{ employee.city }}</td>
                  <td class="text-center">{{ employee.location }}</td>
                  <td class="text-center">{{ employee.organization }}</td>
                  <td class="text-center">{{ employee.nationalIdNumber }}</td>
                  <td class="text-center">{{ employee.svEmployeeNumber }}</td>
                  <td class="text-center">{{ employee.svEmployeeName }}</td>
                  <td class="text-center">{{ employee.costCentre }}</td>
                  <td class="text-center">{{ employee.nationality }}</td>
                  <td class="text-center">
                    {{ employee.companyEmailAddress }}
                  </td>
                  <td class="text-center">{{ employee.contactNumber }}</td>
                  <td class="text-center">{{ employee.grade }}</td>
                  <td class="text-center">{{ employee.licenseNumber }}</td>
                  <td class="text-center">{{ employee.vehicleBudget }}</td>
                  <td>
                    <div class="w-full flex">
                      <p-button
                        [routerLink]="['/view-employee/', employee.id]"
                        pTooltip="View"
                        tooltipPosition="top"
                        icon="bi bi-eye"
                        class="ml mr"
                        [outlined]="true"
                        [rounded]="true"
                        [raised]="true"
                      >
                      </p-button>
                      <p-button
                        *ngIf="selectedStatus.name !== 'Active'"
                        class="bg-color"
                        (click)="activateEmployee(employee.id)"
                        [rounded]="true"
                        pTooltip="Activate"
                        tooltipPosition="top"
                        icon="bi bi-check2"
                        class="ml mr"
                        [outlined]="true"
                        [raised]="true"
                      ></p-button>
                      <p-button
                        [routerLink]="['/edit-employee/', employee.id]"
                        pTooltip="Edit"
                        tooltipPosition="top"
                        icon="bi bi-pen"
                        class="mr"
                        [outlined]="true"
                        [rounded]="true"
                        [raised]="true"
                        severity="success"
                      >
                      </p-button>

                      <p-button
                        [routerLink]="['/employee-attachment', employee.id]"
                        pTooltip="Add Attachments"
                        tooltipPosition="top"
                        icon="bi bi-paperclip"
                        class="ml mr"
                        [outlined]="true"
                        [rounded]="true"
                        [raised]="true"
                        severity="warning"
                      >
                      </p-button>
                      <p-button
                        [routerLink]="[
                          '/individual-file-list-component/',
                          'employee',
                          employee.id
                        ]"
                        pTooltip="Download Attachments"
                        tooltipPosition="top"
                        icon="bi bi-download"
                        class="ml mr"
                        [outlined]="true"
                        [rounded]="true"
                        [raised]="true"
                        severity="success"
                      >
                      </p-button>
                      <!-- <p-button *ngIf="selectedStatus.name === 'Active'" (click)="showDialog(employee.id, $event)" pTooltip="Replace Vehicle" tooltipPosition="top" icon="bi bi-arrow-repeat" class='ml mr' [outlined]="true" [rounded]="true" [raised]="true" severity="help"></p-button> -->
                    </div>
                  </td>
                </tr>
              </ng-template>
            </p-table>
            <div class="card flex justify-content-center">
              <p-paginator
                [rows]="query.size"
                [first]="query.page * query.size"
                [totalRecords]="totalRecords"
                (onPageChange)="onPageChange($event)"
                [alwaysShow]="true"
                [pageLinkSize]="4"
                [showCurrentPageReport]="true"
                currentPageReportTemplate="Showing {{
                  query.page * query.size + 1
                }} to {{ (query.page + 1) * query.size }} of total {{
                  totalRecords
                }} entries"
              >
              </p-paginator>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
